<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [OpenIMSCore-CSCF] [SVN-ser_ims] r6 - in ser_ims/trunk: cfg	modules/icscf modules/pcscf modules/scscf
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openimscore-cscf/2006-November/index.html" >
   <LINK REL="made" HREF="mailto:openimscore-cscf%40lists.berlios.de?Subject=Re%3A%20%5BOpenIMSCore-CSCF%5D%20%5BSVN-ser_ims%5D%20r6%20-%20in%20ser_ims/trunk%3A%20cfg%0A%09modules/icscf%20modules/pcscf%20modules/scscf&In-Reply-To=%3C200611221333.kAMDXakK002120%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="000001.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OpenIMSCore-CSCF] [SVN-ser_ims] r6 - in ser_ims/trunk: cfg	modules/icscf modules/pcscf modules/scscf</H1>
    <B>vingarzan at users.berlios.de</B> 
    <A HREF="mailto:openimscore-cscf%40lists.berlios.de?Subject=Re%3A%20%5BOpenIMSCore-CSCF%5D%20%5BSVN-ser_ims%5D%20r6%20-%20in%20ser_ims/trunk%3A%20cfg%0A%09modules/icscf%20modules/pcscf%20modules/scscf&In-Reply-To=%3C200611221333.kAMDXakK002120%40sheep.berlios.de%3E"
       TITLE="[OpenIMSCore-CSCF] [SVN-ser_ims] r6 - in ser_ims/trunk: cfg	modules/icscf modules/pcscf modules/scscf">vingarzan at users.berlios.de
       </A><BR>
    <I>Wed Nov 22 14:33:36 CET 2006</I>
    <P><UL>
        
        <LI>Next message: <A HREF="000001.html">[OpenIMSCore-CSCF] [SVN-ser_ims] r14 - in ser_ims/trunk: .	.settings cfg
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#0">[ date ]</a>
              <a href="thread.html#0">[ thread ]</a>
              <a href="subject.html#0">[ subject ]</a>
              <a href="author.html#0">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: vingarzan
Date: 2006-11-22 13:43:28 +0100 (Wed, 22 Nov 2006)
New Revision: 6

Added:
   ser_ims/trunk/modules/icscf/cx_avp.c
   ser_ims/trunk/modules/icscf/cx_avp.h
   ser_ims/trunk/modules/icscf/sip.c
   ser_ims/trunk/modules/icscf/sip.h
   ser_ims/trunk/modules/pcscf/sip.c
   ser_ims/trunk/modules/pcscf/sip.h
Removed:
   ser_ims/trunk/modules/icscf/cx_avp.c
   ser_ims/trunk/modules/icscf/cx_avp.h
   ser_ims/trunk/modules/icscf/sip.c
   ser_ims/trunk/modules/icscf/sip.h
   ser_ims/trunk/modules/pcscf/sip.c
   ser_ims/trunk/modules/pcscf/sip.h
Modified:
   ser_ims/trunk/cfg/sip2ims.cfg
   ser_ims/trunk/modules/scscf/cx_avp.c
   ser_ims/trunk/modules/scscf/cx_avp.h
   ser_ims/trunk/modules/scscf/sip.c
   ser_ims/trunk/modules/scscf/sip.h
Log:
- Reworked the sip.c/h and cx_avp.c/h documentation.
- Replaced the sip.c/h and cx_avp.c/h in pcscf/iscscf with links to scscf/*, as these files have the same content for all 3 modules.
- Fixed the sip2ims.cfg with Gustavo's patch.


Modified: ser_ims/trunk/cfg/sip2ims.cfg
===================================================================
--- ser_ims/trunk/cfg/sip2ims.cfg	2006-11-17 23:41:50 UTC (rev 5)
+++ ser_ims/trunk/cfg/sip2ims.cfg	2006-11-22 12:43:28 UTC (rev 6)
@@ -126,8 +126,13 @@
 		exit;
 	}
 	loose_route();
-    if (!t_relay_to_udp(&quot;127.0.0.1&quot;,&quot;4060&quot;)) {
-		sl_send_reply(&quot;500&quot;,&quot;Error forwarding to P-CSCF&quot;);
-    };
+	if (uri==myself||method==&quot;REGISTER&quot;) {
+    	if (!t_relay_to_udp(&quot;127.0.0.1&quot;,&quot;4060&quot;)) {
+			sl_send_reply(&quot;500&quot;,&quot;Error forwarding to P-CSCF&quot;);
+	} else {
+	    if (!t_relay()) {
+    	     sl_reply_error();
+    	}
+    }
     exit;
 }

Deleted: ser_ims/trunk/modules/icscf/cx_avp.c

Added: ser_ims/trunk/modules/icscf/cx_avp.c


Property changes on: ser_ims/trunk/modules/icscf/cx_avp.c
___________________________________________________________________
Name: svn:special
   + *

Deleted: ser_ims/trunk/modules/icscf/cx_avp.h

Added: ser_ims/trunk/modules/icscf/cx_avp.h


Property changes on: ser_ims/trunk/modules/icscf/cx_avp.h
___________________________________________________________________
Name: svn:special
   + *

Deleted: ser_ims/trunk/modules/icscf/sip.c

Added: ser_ims/trunk/modules/icscf/sip.c


Property changes on: ser_ims/trunk/modules/icscf/sip.c
___________________________________________________________________
Name: svn:special
   + *

Deleted: ser_ims/trunk/modules/icscf/sip.h

Added: ser_ims/trunk/modules/icscf/sip.h


Property changes on: ser_ims/trunk/modules/icscf/sip.h
___________________________________________________________________
Name: svn:special
   + *

Deleted: ser_ims/trunk/modules/pcscf/sip.c

Added: ser_ims/trunk/modules/pcscf/sip.c


Property changes on: ser_ims/trunk/modules/pcscf/sip.c
___________________________________________________________________
Name: svn:special
   + *

Deleted: ser_ims/trunk/modules/pcscf/sip.h

Added: ser_ims/trunk/modules/pcscf/sip.h


Property changes on: ser_ims/trunk/modules/pcscf/sip.h
___________________________________________________________________
Name: svn:special
   + *

Modified: ser_ims/trunk/modules/scscf/cx_avp.c
===================================================================
--- ser_ims/trunk/modules/scscf/cx_avp.c	2006-11-17 23:41:50 UTC (rev 5)
+++ ser_ims/trunk/modules/scscf/cx_avp.c	2006-11-22 12:43:28 UTC (rev 6)
@@ -64,18 +64,16 @@
 extern struct cdp_binds cdpb;            /**&lt; Structure with pointers to cdp funcs 		*/
 
 /**
- * Main method for adding diverse entities as AVP.
- * Many methods below with adding functions are the wrapper of
- * this functionality.
- * \param m  Diameter Response
- * \param d String 
- * \param len 
- * \param avp_code AVP Code
- * \param flags for the avp code
- * \param vendorid
- * \param data_do
- * \param func 
- * \return
+ * Create and add an AVP to a Diameter message.
+ * @param m - Diameter message to add to 
+ * @param d - the payload data
+ * @param len - length of the payload data
+ * @param avp_code - the code of the AVP
+ * @param flags - flags for the AVP
+ * @param vendorid - the value of the vendor id or 0 if none
+ * @param data_do - what to do with the data when done
+ * @param func - the name of the calling function, for debugging purposes
+ * @returns 1 on success or 0 on failure
  */
 static inline int Cx_add_avp(AAAMessage *m,char *d,int len,int avp_code,
 	int flags,int vendorid,int data_do,const char *func)
@@ -96,16 +94,16 @@
 }
 
 /**
- * Adds an Attribute Value Pair to the list
- * \param m  Diameter Response
- * \param d String 
- * \param len 
- * \param avp_code AVP Code
- * \param flags for the avp code
- * \param vendorid
- * \param data_do
- * \param func 
- * \return
+ * Create and add an AVP to a list of AVPs.
+ * @param list - the AVP list to add to 
+ * @param d - the payload data
+ * @param len - length of the payload data
+ * @param avp_code - the code of the AVP
+ * @param flags - flags for the AVP
+ * @param vendorid - the value of the vendor id or 0 if none
+ * @param data_do - what to do with the data when done
+ * @param func - the name of the calling function, for debugging purposes
+ * @returns 1 on success or 0 on failure
  */
 static inline int Cx_add_avp_list(AAA_AVP_LIST *list,char *d,int len,int avp_code,
 	int flags,int vendorid,int data_do,const char *func)
@@ -133,12 +131,12 @@
 }
 
 /**
- * Gets Information of AVP field given in avp_code
- * \param msg Diameter Response
- * \param avp_code query field of Information
- * \param vendor_id
- * \param func 
- * \return data as String on success, 0 on fail
+ * Returns the value of a certain AVP from a Diameter message.
+ * @param m - Diameter message to look into
+ * @param avp_code - the code to search for
+ * @param vendorid - the value of the vendor id to look for or 0 if none
+ * @param func - the name of the calling function, for debugging purposes
+ * @returns the str with the payload on success or an empty string on failure
  */
 static inline str Cx_get_avp(AAAMessage *msg,int avp_code,int vendor_id,
 							const char *func)
@@ -159,10 +157,10 @@
 
 
 /**
- * Creates an AVP with User Name
- * \param msg  Diameter Response
- * \param data String 
- * \return 1 on success 0 on fail
+ * Creates and adds a User-Name AVP.
+ * @param msg - the Diameter message to add to.
+ * @param data - the value for the AVP payload
+ * @returns 1 on success or 0 on error
  */
 inline int Cx_add_user_name(AAAMessage *msg,str data)
 {
@@ -176,10 +174,10 @@
 }
 
 /**
- * Creates an AVP with public Identity
- * \param msg  Diameter Response
- * \param data String 
- * \return 1 on success 0 on fail
+ * Creates and adds a Public Identity AVP.
+ * @param msg - the Diameter message to add to.
+ * @param data - the value for the AVP payload
+ * @returns 1 on success or 0 on error
  */
 inline int Cx_add_public_identity(AAAMessage *msg,str data)
 {
@@ -193,10 +191,10 @@
 }
 
 /**
- * Creates an AVP with Network ID (visited)
- * \param msg  Diameter Response
- * \param data String 
- * \return 1 on success 0 on fail
+ * Creates and adds a Visited-Network-ID AVP.
+ * @param msg - the Diameter message to add to.
+ * @param data - the value for the AVP payload
+ * @returns 1 on success or 0 on error
  */
 inline int Cx_add_visited_network_id(AAAMessage *msg,str data)
 {
@@ -210,10 +208,10 @@
 }
 
 /**
- * Creates an AVP with authorization type
- * \param msg  Diameter Response
- * \param data 
- * \return 1 on success 0 on fail
+ * Creates and adds a Authorization-Type AVP.
+ * @param msg - the Diameter message to add to.
+ * @param data - the value for the AVP payload
+ * @returns 1 on success or 0 on error
  */
 inline int Cx_add_authorization_type(AAAMessage *msg,unsigned int data)
 {
@@ -230,10 +228,10 @@
 
 
 /**
- * Adds a server name
- * \param msg  Diameter Response
- * \param data 
- * \return Cx_add_avp
+ * Creates and adds a Server-Name AVP.
+ * @param msg - the Diameter message to add to.
+ * @param data - the value for the AVP payload
+ * @returns 1 on success or 0 on error
  */
 inline int Cx_add_server_name(AAAMessage *msg,str data)
 {
@@ -247,10 +245,10 @@
 }
 
 /**
- * Adding sip numbers of authorized entities
- * \param msg  Diameter Response
- * \param data sip number
- * \return 1 on success 0 on fail
+ * Creates and adds a SIP-Number-Auth-Items AVP.
+ * @param msg - the Diameter message to add to.
+ * @param data - the value for the AVP payload
+ * @returns 1 on success or 0 on error
  */
 inline int Cx_add_sip_number_auth_items(AAAMessage *msg,unsigned int data)
 {
@@ -268,11 +266,11 @@
 
 
 /**
- * Adds sip authorization data 
- * \param msg  Diameter Response
- * \param auth_scheme Authentication Scheme 
- * \paramauth Authorization
- * \return 1 on success 0 on fail
+ * Creates and adds a SIP-Auth-Data-Item AVP.
+ * @param msg - the Diameter message to add to.
+ * @param auth_scheme - the value for the authorization scheme AVP
+ * @param auth - the value for the authorization AVP
+ * @returns 1 on success or 0 on error
  */
 inline int Cx_add_sip_auth_data_item_request(AAAMessage *msg,str auth_scheme,str auth)
 {
@@ -313,10 +311,10 @@
 }
 
 /**
- * Adds an Assignment type.
- * \param msg  Diameter Response
- * \param data
- * \return 1 on success 0 on fail
+ * Creates and adds a Server-Assignment-Type AVP.
+ * @param msg - the Diameter message to add to.
+ * @param data - the value for the AVP payload
+ * @returns 1 on success or 0 on error
  */
 inline int Cx_add_server_assignment_type(AAAMessage *msg,unsigned int data)
 {
@@ -332,10 +330,10 @@
 }
 
 /**
- * Adds an Attribute Value Pair for availibility of userdaata
- * \param msg  Diameter Response
- * \param data
- * \return 1 on success 0 on fail
+ * Creates and adds Userdata-Available AVP.
+ * @param msg - the Diameter message to add to.
+ * @param data - the value for the AVP payload
+ * @returns 1 on success or 0 on error
  */
 inline int Cx_add_userdata_available(AAAMessage *msg,unsigned int data)
 {
@@ -351,10 +349,10 @@
 }
 
 /**
- * Adds an Attribute Value Pair with result code
- * \param msg  Diameter Response
- * \param data 
- * \return 1 on success 0 on fai
+ * Creates and adds a Result-Code AVP.
+ * @param msg - the Diameter message to add to.
+ * @param data - the value for the AVP payload
+ * @returns 1 on success or 0 on error
  */
 inline int Cx_add_result_code(AAAMessage *msg,unsigned int data)
 {
@@ -370,10 +368,10 @@
 }
 
 /**
- * Experimental Result Codes
- * \param msg  Diameter Response
- * \param data 
- * \return 1 on success 0 on fail
+ * Creates and adds a Experimental-Result-Code AVP.
+ * @param msg - the Diameter message to add to.
+ * @param data - the value for the AVP payload
+ * @returns 1 on success or 0 on error
  */
 inline int Cx_add_experimental_result_code(AAAMessage *msg,unsigned int data)
 {
@@ -415,12 +413,12 @@
 }
 
 /**
- * Adds Specific application_id
- * \param msg  Diameter Response
- * \param vendor_id
- * \param auth_id Authorization Application ID
- * \param acct_id Accounting Application ID
- * \return 
+ * Creates and adds a Vendor-Specifig-Application-ID AVP.
+ * @param msg - the Diameter message to add to.
+ * @param vendor_id - the value of the vendor_id,
+ * @param auth_id - the authorization application id
+ * @param acct_id - the accounting application id
+ * @returns 1 on success or 0 on error
  */
 inline int Cx_add_vendor_specific_appid(AAAMessage *msg,unsigned int vendor_id,
 	unsigned int auth_id,unsigned int acct_id)
@@ -476,10 +474,10 @@
 
 
 /**
- * Adds an AVP with session state of Authorization
- * \param msg Diameter Response
- * \param data 
- * \return 1 on success 0 on fail
+ * Creates and adds a Auth-Session-State AVP.
+ * @param msg - the Diameter message to add to.
+ * @param data - the value for the AVP payload
+ * @returns 1 on success or 0 on error
  */
 inline int Cx_add_auth_session_state(AAAMessage *msg,unsigned int data)
 {
@@ -495,10 +493,10 @@
 }
 
 /**
- * Adds an Attribute Value Pair of user destionation realm
- * \param msg  Diameter Response
- * \param data String 
- * \return 1 on success 0 on fail
+ * Creates and adds a Destination-Realm AVP.
+ * @param msg - the Diameter message to add to.
+ * @param data - the value for the AVP payload
+ * @returns 1 on success or 0 on error
  */
 inline int Cx_add_destination_realm(AAAMessage *msg,str data)
 {
@@ -513,9 +511,9 @@
 
 
 /**
- * Gets the session id for that call
- * \param msg  Diameter Response
- * \return Session_Id on success 0 on fail
+ * Returns the Session-Id AVP of a Diameter message.
+ * @param msg - the Diameter message
+ * @returns AVP payload on success or an empty string on error
  */
 inline str Cx_get_session_id(AAAMessage *msg)
 {
@@ -527,10 +525,9 @@
 
 
 /**
- * get the User Name from the Response
- * \param msg  Diameter Response(pointer)
- * \return str as User_Name
- * \return user_name on success 0 on fail
+ * Returns the User-Name AVP from a Diameter message.
+ * @param msg - the Diameter message
+ * @returns the AVP payload on success or an empty string on error
  */
 inline str Cx_get_user_name(AAAMessage *msg)
 {
@@ -541,9 +538,9 @@
 }
 
 /**
- * Get IMS Public Identity
- * \param msg  Diameter Response
- * \return identity on success 0 on fail
+ * Returns the Public-Identity AVP from a Diameter message.
+ * @param msg - the Diameter message
+ * @returns the AVP payload on success or an empty string on error
  */
 inline str Cx_get_public_identity(AAAMessage *msg)
 {
@@ -554,16 +551,16 @@
 }
 
 /**
- * Finds out the next public Identity from response
- * \param msg  Diameter Response
- * \param pos  position 
- * \param avp_code AVP Code
- * \param vendor_id
- * \param func function
- * \return Attribute-Value-Pair
+ * Finds out the next Public-Identity AVP from a Diameter message.
+ * @param msg - the Diameter message
+ * @param pos - position to resume search or NULL if to start from the first AVP 
+ * @param avp_code - the code of the AVP to look for
+ * @param vendor_id - the vendor id of the AVP to look for
+ * @param func - the name of the calling function for debugging purposes
+ * @returns the AVP payload on success or an empty string on error
  */
-inline AAA_AVP* Cx_get_next_public_identity(AAAMessage *msg,AAA_AVP* pos,int avp_code,int vendor_id,const char *func){		
-{
+inline AAA_AVP* Cx_get_next_public_identity(AAAMessage *msg,AAA_AVP* pos,int avp_code,int vendor_id,const char *func)
+{		
 	AAA_AVP *avp;
 	
 	avp = cdpb.AAAFindMatchingAVP(msg,pos,avp_code,vendor_id,0);
@@ -574,14 +571,11 @@
 	else 
 		return avp;
 }
-	
-	
-}
 
 /**
- * Get the Identifier of a visited network
- * \param msg  Diameter Response
- * \return the network ID on success 0 on fail
+ * Returns the Visited-Network-ID AVP from a Diameter message.
+ * @param msg - the Diameter message
+ * @returns the AVP payload on success or an empty string on error
  */
 inline str Cx_get_visited_network_id(AAAMessage *msg)
 {
@@ -592,10 +586,9 @@
 }
 
 /**
- * Getter for Authorization Type of IMS User
- * \param msg Diameter Response
- * \param d Authorization Type
- * \return 1 on success 0 on fail
+ * Returns the Authorization-Type AVP from a Diameter message.
+ * @param msg - the Diameter message
+ * @returns the AVP payload on success or an empty string on error
  */
 inline int Cx_get_authorization_type(AAAMessage *msg, int *data)
 {
@@ -610,10 +603,9 @@
 }
 
 /**
- * Adds an Attribute Value Pair to the list
- * \param msg  Diameter Response
- * \param data Assignment Type
- * \return 1 on success 0 on fail
+ * Returns the Server-Assignment-Type AVP from a Diameter message.
+ * @param msg - the Diameter message
+ * @returns the AVP payload on success or an empty string on error
  */
 inline int Cx_get_server_assignment_type(AAAMessage *msg, int *data)
 {
@@ -628,10 +620,9 @@
 }
 
 /**
- * Checks out if the userdata is availible
- * \param msg  Diameter Response
- * \param data Availibility
- * \return 1 on success 0 on fail
+ * Returns the User-Data-Available AVP from a Diameter message.
+ * @param msg - the Diameter message
+ * @returns the AVP payload on success or an empty string on error
  */
 inline int Cx_get_userdata_available(AAAMessage *msg, int *data)
 {
@@ -647,10 +638,9 @@
 
 
 /**
- * Gets the result code
- * \param msg  Diameter Response
- * \param data integer pointer
- * \return 1 on success 0 on fail
+ * Returns the Result-Code AVP from a Diameter message.
+ * @param msg - the Diameter message
+ * @returns the AVP payload on success or an empty string on error
  */
 inline int Cx_get_result_code(AAAMessage *msg, int *data)
 {
@@ -665,10 +655,9 @@
 }
 
 /**
- * Get experimental results
- * \param msg  Diameter Response
- * \param data pointer to int
- * \return 1 on success 0 on fail
+ * Returns the Experimental-Result-Code AVP from a Diameter message.
+ * @param msg - the Diameter message
+ * @returns the AVP payload on success or an empty string on error
  */
 inline int Cx_get_experimental_result_code(AAAMessage *msg, int *data)
 {
@@ -696,9 +685,9 @@
 }
 
 /**
- * Get the IMS Server Name
- * \param msg Diameter Response
- * \return IMS Server Name on successs 0 on fail
+ * Returns the Server-Name AVP from a Diameter message.
+ * @param msg - the Diameter message
+ * @returns the AVP payload on success or an empty string on error
  */
 inline str Cx_get_server_name(AAAMessage *msg)
 {	
@@ -710,13 +699,13 @@
 
 
 /**
- * Gets IMS Server Mandatory/Optional Capabilities
- * \param msg  Diameter Response
- * \param int m Memory in bytes needed for mandatory caps.
- * \param int m_cnt mandatory cap. counter
- * \param int o Memory in bytes needed for opt.caps.
- * \param int o_cnt optional cap. counter
- * \return 1 on success 0 on fail
+ * Returns the Capabilities from the grouped AVP from a Diameter message.
+ * @param msg - the Diameter message
+ * @param m - array to be filled with the retrieved mandatory capabilities
+ * @param m_cnt - size of the array above to be filled
+ * @param o - array to be filled with the retrieved optional capabilities
+ * @param o_cnt - size of the array above to be filled
+ * @returns 1 on success 0 on fail
  */
 inline int Cx_get_capabilities(AAAMessage *msg,int **m,int *m_cnt,int **o,int *o_cnt)
 {
@@ -756,10 +745,9 @@
 }
 
 /**
- * Get sip numbers of authorized entities
- * \param msg  Diameter Response
- * \param data 
- * \return 1 on success 0 on fail.
+ * Returns the SIP-Number-Auth-Items AVP from a Diameter message.
+ * @param msg - the Diameter message
+ * @returns the number or 0 on error
  */
 inline int Cx_get_sip_number_auth_items(AAAMessage *msg, int *data)
 {
@@ -773,12 +761,13 @@
 	return 1;
 }
 
+
 /**
- * Gets a matching Authentication Scheme from the AVP list
- * \param msg  Diameter Response
- * \param auth_scheme as  Authentication Scheme - String 
- * \param authorization as String
- * \return 1 on success 0 on fail
+ * Returns the Auth-Data-Item from a Diameter Request message.
+ * @param msg - the Diameter message
+ * @param auth_scheme - the string to fill with the authorization scheme
+ * @param authorization - the string to fill with the authorization
+ * @returns the AVP payload on success or an empty string on error
  */
 inline int Cx_get_auth_data_item_request(AAAMessage *msg,
 		 str *auth_scheme, str *authorization)
@@ -812,16 +801,16 @@
 }
 
 /**
- * Get Authentication Data Item
- * \param msg  Diameter Response
- * \param auth_data Authentication Data(double pointer)
- * \param item_number 
- * \param auth_scheme
- * \param authenticate 
- * \param authorization
- * \param ck
- * \param ik
- * \return 1 on success 0 on fail
+ * Returns the Auth-Data-Item from a Diameter answer message.
+ * @param msg - the Diameter message
+ * @param auth_date - the string to fill with the authorization data
+ * @param item_number - the int to fill with the item number
+ * @param auth_scheme - the string to fill with the authentication scheme data
+ * @param authenticate - the string to fill with the authenticate data
+ * @param authorization - the string to fill with the authorization data
+ * @param ck - the string to fill with the cipher key
+ * @param ik - the string to fill with the integrity key
+ * @returns the AVP payload on success or an empty string on error
  */
 int Cx_get_auth_data_item_answer(AAAMessage *msg, AAA_AVP **auth_data,
 	int *item_number,str *auth_scheme,str *authenticate,str *authorization,
@@ -876,9 +865,9 @@
 
 
 /**
- * Delivers the destination of the host from the response
- * \param msg  Diameter Response
- * \return location on success 0 on fail
+ * Returns the Destination-Host from a Diameter message.
+ * @param msg - the Diameter message
+ * @returns the AVP payload on success or an empty string on error
  */
 inline str Cx_get_destination_host(AAAMessage *msg)
 {	
@@ -889,9 +878,9 @@
 }
 
 /**
- * Delivers the user data from HSS Response
- * \param msg  Diameter Response
- * \return the user data on success 0 on fail
+ * Returns the User-Data from a Diameter message.
+ * @param msg - the Diameter message
+ * @returns the AVP payload on success or an empty string on error
  */
 inline str Cx_get_user_data(AAAMessage *msg)
 {	
@@ -902,9 +891,9 @@
 }
 
 /**
- * Chops out the Information for charging purposes
- * \param msg  Diameter Response
- * \return charging_info on success 0 on fail
+ * Returns the Charging-Information from a Diameter message.
+ * @param msg - the Diameter message
+ * @returns the AVP payload on success or an empty string on error
  */
 inline str Cx_get_charging_info(AAAMessage *msg)
 {	

Modified: ser_ims/trunk/modules/scscf/cx_avp.h
===================================================================
--- ser_ims/trunk/modules/scscf/cx_avp.h	2006-11-17 23:41:50 UTC (rev 5)
+++ ser_ims/trunk/modules/scscf/cx_avp.h	2006-11-22 12:43:28 UTC (rev 6)
@@ -1,8 +1,55 @@
-/**
- * $Id$ cx_avp.h $Date$ $Author$ dvi Dragos Vingarzan
+/*
+ * $Id$
+ *  
+ * Copyright (C) 2004-2006 FhG Fokus
  *
- * I/S-CSCF Module - Cx AVP Operations
+ * This file is part of Open IMS Core - an open source IMS CSCFs &amp; HSS
+ * implementation
+ *
+ * Open IMS Core is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * For a license to use the Open IMS Core software under conditions
+ * other than those described here, or to purchase support for this
+ * software, please contact Fraunhofer FOKUS by e-mail at the following
+ * addresses:
+ *     <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-cscf">info at open-ims.org</A>
+ *
+ * Open IMS Core is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
  * 
+ * It has to be noted that this Open Source IMS Core System is not 
+ * intended to become or act as a product in a commercial context! Its 
+ * sole purpose is to provide an IMS core reference implementation for 
+ * IMS technology testing and IMS application prototyping for research 
+ * purposes, typically performed in IMS test-beds.
+ * 
+ * Users of the Open Source IMS Core System have to be aware that IMS
+ * technology may be subject of patents and licence terms, as being 
+ * specified within the various IMS-related IETF, ITU-T, ETSI, and 3GPP
+ * standards. Thus all Open IMS Core users have to take notice of this 
+ * fact and have to agree to check out carefully before installing, 
+ * using and extending the Open Source IMS Core System, if related 
+ * patents and licences may become applicable to the intended usage 
+ * context.  
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+ * 
+ */
+
+ /**
+ * \file
+ *
+ * I/S-CSCF Module - Cx AVP Operations  
+ * 
+ *  \author Dragos Vingarzan vingarzan -at- fokus dot fraunhofer dot de
+ * 
  * Copyright (C) 2005 FhG Fokus
  * 		
  */

Modified: ser_ims/trunk/modules/scscf/sip.c
===================================================================
--- ser_ims/trunk/modules/scscf/sip.c	2006-11-17 23:41:50 UTC (rev 5)
+++ ser_ims/trunk/modules/scscf/sip.c	2006-11-22 12:43:28 UTC (rev 6)
@@ -46,7 +46,7 @@
  /**
  * \file
  *
- * I/S-CSCF Module - Main SIP Operations 
+ * P/I/S-CSCF Module - Main SIP Operations 
  * 
  *  \author Dragos Vingarzan vingarzan -at- fokus dot fraunhofer dot de
  * 
@@ -75,9 +75,9 @@
 
 /**
  * Adds a header to the message as the first one in the message
- * \param msg - the message to add a header to
- * \param content - the str containing the new header
- * \return 1 on succes, 0 on failure
+ * @param msg - the message to add a header to
+ * @param content - the str containing the new header
+ * @returns 1 on succes, 0 on failure
  */
 int cscf_add_header_first(struct sip_msg *msg, str *hdr)
 {
@@ -101,9 +101,9 @@
 
 /**
  * Adds a header to the message
- * \param msg - the message to add a header to
- * \param content - the str containing the new header
- * \return 1 on succes, 0 on failure
+ * @param msg - the message to add a header to
+ * @param content - the str containing the new header
+ * @returns 1 on succes, 0 on failure
  */
 int cscf_add_header(struct sip_msg *msg, str *hdr,int type)
 {
@@ -124,11 +124,12 @@
 	}	
  	return 1;
 }
+
 /**
  * Adds a header to the reply message
- * \param msg - the message to add a header to its reply
- * \param content - the str containing the new header
- * \return 1 on succes, 0 on failure
+ * @param msg - the request to add a header to its reply
+ * @param content - the str containing the new header
+ * @returns 1 on succes, 0 on failure
  */
 int cscf_add_header_rpl(struct sip_msg *msg, str *hdr)
 {
@@ -145,9 +146,9 @@
 
 /**
  * Delete the given header from the given message
- * \param msg - the message to delete the header from
- * \param hdr - the header to delete. !!! Must be contained in the msg-&gt;headers
- * \return 1 on success, 0 on failure
+ * @param msg - the message to delete the header from
+ * @param hdr - the header to delete. !!! Must be contained in the msg-&gt;headers
+ * @returns 1 on success, 0 on failure
  */
 int cscf_delete_header(struct sip_msg *msg, struct hdr_field *hdr)
 {
@@ -163,10 +164,10 @@
 /**
  * Returns the Private Identity extracted from the Authorization header.
  * If none found there takes the SIP URI in To without the &quot;sip:&quot; prefix
- * TODO - remove the fallback case to the To header
- * \param msg - the SIP message
- * \param realm - the realm to match in an Authorization header
- * \return the str containing the private id, no mem dup
+ * \todo - remove the fallback case to the To header
+ * @param msg - the SIP message
+ * @param realm - the realm to match in an Authorization header
+ * @returns the str containing the private id, no mem dup
  */
 str cscf_get_private_identity(struct sip_msg *msg, str realm)
 {
@@ -212,8 +213,8 @@
 
 /**
  * Returns the Public Identity extracted from the To header
- * \param msg - the SIP message
- * \return the str containing the private id, no mem dup
+ * @param msg - the SIP message
+ * @returns the str containing the private id, no mem dup
  */
 str cscf_get_public_identity(struct sip_msg *msg)
 {
@@ -244,8 +245,8 @@
 /**
  * Returns the expires value from the Expires header in the message.
  * It searches into the Expires header and if not found returns -1
- * \param msg - the SIP message, if available
- * \return the value of the expire or -1 if not found
+ * @param msg - the SIP message, if available
+ * @returns the value of the expire or -1 if not found
  */
 int cscf_get_expires_hdr(struct sip_msg *msg)
 {
@@ -271,12 +272,13 @@
 	}
 	return -1;
 }
+
 /**
  * Returns the expires value from the message.
  * First it searches into the Expires header and if not found it also looks 
  * into the expires parameter in the contact header
- * \param msg - the SIP message
- * \return the value of the expire or the default 3600 if none found
+ * @param msg - the SIP message
+ * @returns the value of the expire or the default 3600 if none found
  */
 int cscf_get_expires(struct sip_msg *msg)
 {
@@ -324,8 +326,8 @@
 
 /**
  * Get the Public Identity from the Request URI of the message
- * \param msg - the SIP message
- * \return the public identity
+ * @param msg - the SIP message
+ * @returns the public identity
  */
 str cscf_get_public_identity_from_requri(struct sip_msg *msg)
 {
@@ -355,8 +357,9 @@
 
 /**
  * Retrieves the SIP request that generated a diameter transaction
- * \param t - the diameter transaction
- * \return the SIP request
+ * @param hash - the tm hash value for this request
+ * @param label - the tm label value for this request
+ * @returns the SIP request
  */
 struct sip_msg *cscf_get_request(unsigned int hash,unsigned int label)
 {
@@ -371,13 +374,13 @@
 
 static str s_ip={&quot;integrity-protected&quot;,19};
 /**
- * Returns if the SIP message should be integrity protected.
- * The integrity-protected field in the in the Authorization header
- * TODO - optimize it by including the integrity protected parameter in the
+ * Returns if the SIP message is integrity protected.
+ * Looks for the integrity-protected field in the in the Authorization header.
+ * \todo - optimize it by including the integrity protected parameter in the
  * digest parsed structures - will change the core though...
- * \param msg - the SIP message
- * \param realm - the realm
- * \return 1 if integrity protected is set to yes, 0 if it is not set to yes or is
+ * @param msg - the SIP message
+ * @param realm - the realm to match in the authorization
+ * @returns 1 if integrity protected is set to yes, 0 if it is not set to yes or is
  * missing
  */
 int cscf_get_integrity_protected(struct sip_msg *msg,str realm)
@@ -419,12 +422,12 @@
 
 
 /**
- * Returns the transaction identifiers.
+ * Returns the tm transaction identifiers for a message.
  * If no transaction, then creates one
- * \param msg - the SIP message
- * \param hash - where to write the hash
- * \param label - where to write the label
- * \return 1 on success and creation of a new transaction, 0 if transaction existed,
+ * @param msg - the SIP message
+ * @param hash - where to write the hash
+ * @param label - where to write the label
+ * @returns 1 on success and creation of a new transaction, 0 if transaction existed,
  * -1 if failure
  */
 int cscf_get_transaction(struct sip_msg *msg, unsigned int *hash,unsigned int *label)
@@ -450,7 +453,11 @@
 }
 
 /**
- * Transactional response - tries to create a transaction if none found
+ * Transactional SIP response - tries to create a transaction if none found.
+ * @param msg - message to reply to
+ * @param code - the Status-code for the response
+ * @param text - the Reason-Phrase for the response
+ * @returns the tmb.t_repy() result
  */
 int cscf_reply_transactional(struct sip_msg *msg, int code, char *text)
 {
@@ -462,11 +469,12 @@
 	}
 	return tmb.t_reply(msg,code,text);
 }
+
 /**
  * Looks for the auts parameter in the Authorization header and returns its value.
- * \param msg - the SIP message
- * \param realm - realm to match the right Authorization header
- * \return 1 the auts
+ * @param msg - the SIP message
+ * @param realm - realm to match the right Authorization header
+ * @returns the auts value or an empty string if not found
  */
 str cscf_get_auts(struct sip_msg *msg, str realm)
 {
@@ -509,9 +517,9 @@
 
 /**
  * Looks for the nonce parameter in the Authorization header and returns its value.
- * \param msg - the SIP message
- * \param realm - realm to match the right Authorization header
- * \return the nonce
+ * @param msg - the SIP message
+ * @param realm - realm to match the right Authorization header
+ * @returns the nonce or an empty string if none found
  */
 str cscf_get_nonce(struct sip_msg *msg, str realm)
 {
@@ -548,9 +556,9 @@
 
 /**
  * Looks for the algorithm parameter in the Authorization header and returns its value.
- * \param msg - the SIP message
- * \param realm - realm to match the right Authorization header
- * \return the nonce
+ * @param msg - the SIP message
+ * @param realm - realm to match the right Authorization header
+ * @returns the algorithm or an empty string if not found
  */
 str cscf_get_algorithm(struct sip_msg *msg, str realm)
 {
@@ -586,9 +594,9 @@
 
 /**
  * Looks for the uri parameter in the Authorization header and returns its value.
- * \param msg - the SIP message
- * \param realm - realm to match the right Authorization header
- * \return the nonce
+ * @param msg - the SIP message
+ * @param realm - realm to match the right Authorization header
+ * @returns the uri in the digest
  */
 str cscf_get_digest_uri(struct sip_msg *msg, str realm)
 {
@@ -621,11 +629,14 @@
 	}
 	return uri;	
 }
+
 /**
  * Looks for the nonce and response parameters in the Authorization header and returns them
- * \param msg - the SIP message
- * \param realm - realm to match the right Authorization header
- * \return the nonce
+ * @param msg - the SIP message
+ * @param realm - realm to match the right Authorization header
+ * @param nonce - param to fill with the nonce found
+ * @param response - param to fill with the response
+ * @returns 1 if found, 0 if not
  */
 int cscf_get_nonce_response(struct sip_msg *msg, str realm,str *nonce,str *response)
 {
@@ -664,10 +675,9 @@
 str ua_dummy={&quot;Unknown UA&quot;,10};
 str ua_nomsg={&quot;No Message&quot;,10};
 /**
- * Looks for the UserAgent header and extracts its content
- * \param msg - the sip message
- * \return the user agent string, or ua_dummy if not found, or ua_nomsg if msg was
- * NULL
+ * Looks for the User-Agent header and extracts its content.
+ * @param msg - the sip message
+ * @returns the user agent string, or ua_dummy if not found, or ua_nomsg if msg was NULL
  */
 str cscf_get_user_agent(struct sip_msg *msg)
 {
@@ -685,9 +695,9 @@
 }
 
 /**
- * Parses all the contact headers
- * \param msg - the SIP message
- * \return the first contact_body
+ * Parses all the contact headers.
+ * @param msg - the SIP message
+ * @returns the first contact_body
  */
 contact_body_t *cscf_parse_contacts(struct sip_msg *msg)
 {
@@ -718,8 +728,8 @@
 
 /**
  * Retrieve a list of concatenated contents of Path headers found in the message
- * \param msg - the SIP message containing the Path headers
- * \return pkg mem allocated str with the headers values separated by ','
+ * @param msg - the SIP message containing the Path headers
+ * @returns pkg mem allocated str with the headers values separated by ','
  */
 str cscf_get_path(struct sip_msg *msg)
 {
@@ -761,9 +771,9 @@
 }
 
 /**
- * Looks for the Event header and extracts its content
- * \param msg - the sip message
- * \return the event value
+ * Looks for the Event header and extracts its content.
+ * @param msg - the sip message
+ * @returns the string event value or an empty string if none found
  */
 str cscf_get_event(struct sip_msg *msg)
 {
@@ -780,8 +790,8 @@
 
 /**
  * Looks for the P-Asserted-Identity header and extracts its content
- * \param msg - the sip message
- * \return the event value
+ * @param msg - the sip message
+ * @returns the asserted identity
  */
 str cscf_get_asserted_identity(struct sip_msg *msg)
 {
@@ -815,8 +825,8 @@
 
 /**
  * Looks for the Contact header and extracts its content
- * \param msg - the sip message
- * \return the event value
+ * @param msg - the sip message
+ * @returns the first contact in the message
  */
 str cscf_get_contact(struct sip_msg *msg)
 {
@@ -853,8 +863,9 @@
 
 /**
  * Looks for the First Route header
- * \param msg - the sip message
- * \return the event value
+ * @param msg - the sip message
+ * @param hr - param to return the ptr to the found header
+ * @returns the first route string
  */
 str cscf_get_first_route(struct sip_msg *msg,struct hdr_field **hr)
 {
@@ -888,9 +899,9 @@
 /**
  * Looks if the first entry in the first Route points is equal to the given value and
  * deletes the old header. If there are more entries inserts a new header at top with those values.
- * \param msg - the SIP message
- * \param value - the value to look for
- * \return 1 if removed, else 0
+ * @param msg - the SIP message
+ * @param value - the value to look for
+ * @returns 1 if removed, else 0
  */
 int cscf_remove_first_route(struct sip_msg *msg,str value)
 {
@@ -936,8 +947,8 @@
 
 /**
  * Returns if the uri is of myself
- * \param uri as string
- * \return 1 on success 0 on fail
+ * @param uri as string
+ * @returns 1 on success 0 on fail
  */
 inline int cscf_is_myself(str uri)
 {
@@ -955,11 +966,13 @@
 	
 	return ret;
 }
+
 /**
  * Looks if the first entry in the first Route points to myself and if positive, it removes it
  * deletes the old header. If there are more entries inserts a new header at top with those values.
- * \param msg - the SIP message
- * \return 1 if removed, else 0
+ * @param msg - the SIP message
+ * @param h - ptr to return the found hdr_field 
+ * @returns 1 if removed, else 0
  */
 int cscf_remove_own_route(struct sip_msg *msg,struct hdr_field **h)
 {
@@ -1004,9 +1017,9 @@
 
 static str s_record_route={&quot;Record-route&quot;,12};
 /**
- * Returns all the record routes concatenated.
- * \param msg sip message
- * \return concatenated routes as String
+ * Returns all the record routes, concatenated.
+ * @param msg sip message
+ * @returns concatenated routes as String
  */
 str cscf_get_record_routes(struct sip_msg *msg)
 {
@@ -1038,11 +1051,12 @@
 	}	
 	return route;
 }
+
 /**
- * Returns the next record route
- * \param msg as sip_msg (pointer)
- * \param start as header_field (pointer) 
- * \return header field on success 0 on fail 
+ * Returns the next record route header
+ * @param msg - the SIP message
+ * @param start - The header to start searching from or NULL if from first header 
+ * @returns header field on success or NULL on error 
  */
 struct hdr_field* cscf_get_next_record_route(struct sip_msg *msg,struct hdr_field *start)
 {
@@ -1077,8 +1091,8 @@
 
 /** 
  * Delivers the Realm from request URI
- * \param msg sip message 
- * \return realm as String on success 0 on fail
+ * @param msg sip message 
+ * @returns realm as String on success 0 on fail
  */
 str cscf_get_realm_from_ruri(struct sip_msg *msg)
 {
@@ -1096,8 +1110,8 @@
 
 /**
  * Gets identity from the request URI 
- * \param msg sip message 
- * \return Address of the request as String on success 0 on fail
+ * @param msg sip message 
+ * @returns Address of the request as String on success 0 on fail
  */
 str cscf_get_identity_from_ruri(struct sip_msg *msg)
 {
@@ -1128,8 +1142,9 @@
 
 /**
  * Looks for the Call-ID header
- * \param msg - the sip message
- * \return the callid value
+ * @param msg - the sip message
+ * @param hr - ptr to return the found hdr_field 
+ * @returns the callid value
  */
 str cscf_get_call_id(struct sip_msg *msg,struct hdr_field **hr)
 {
@@ -1154,8 +1169,9 @@
 
 /**
  * Looks for the Call-ID header
- * \param msg - the sip message
- * \return the callid value
+ * @param msg - the sip message
+ * @param hr - ptr to return the found hdr_field 
+ * @returns the callid value
  */
 int cscf_get_cseq(struct sip_msg *msg,struct hdr_field **hr)
 {
@@ -1191,7 +1207,9 @@
 }
 
 /** 
- * Returns the corresponding request for a reply, using tm transactions
+ * Returns the corresponding request for a reply, using tm transactions.
+ * @param reply - the reply to find request for
+ * @returns the transactional request
  */
 struct sip_msg* cscf_get_request_from_reply(struct sip_msg *reply)
 {
@@ -1207,9 +1225,10 @@
 
 static str s_called_party_id={&quot;P-Called-Party-ID&quot;,17};
 /**
- * Looks for the P-Preferred-Identity header and extracts its content
- * \param msg - the sip message
- * \return the event value
+ * Looks for the P-Preferred-Identity header and extracts its content.
+ * @param msg - the sip message
+ * @param hr - ptr to return the found hdr_field 
+ * @returns the P-Called_Party-ID
  */
 str cscf_get_called_party_id(struct sip_msg *msg,struct hdr_field **hr)
 {
@@ -1247,9 +1266,10 @@
 static str s_active={&quot;active&quot;,6};
 static str s_terminated={&quot;terminated&quot;,10};
 static str s_expires={&quot;expires=&quot;,8};
- /* Looks for the Subscription-State header and extracts its content
- * \param msg - the sip message
- * \return expiration if active, -1 if not found, -2 if terminated
+/**
+ * Looks for the Subscription-State header and extracts its content
+ * @param msg - the sip message
+ * @returns expiration if active, -1 if not found, -2 if terminated
  */
 int cscf_get_subscription_state(struct sip_msg *msg)
 {
@@ -1301,11 +1321,12 @@
 }
 
 /**
- * Search &amp; Replace strings in a sip message
- * \param msg sip message(pointer) 
- * \param orig the string to be replaced
- * \param repl string to insert
- * \return 1 on success 0 on fail
+ * Replace a string in a message with another one.
+ * \note the orig string MUST be allocated in the limits of msg-&gt;buf.
+ * @param msg - the SIP message to modify 
+ * @param orig - the string to be replaced
+ * @param repl - string to replace with
+ * @returns 1 on success 0 on fail (the original string was not in the original SIP message)
  */ 
 int cscf_replace_string(struct sip_msg *msg, str orig,str repl)
 {
@@ -1333,12 +1354,11 @@
 }
 
 /**
- * Delivers the contents of the header fields of a sip message
- * \param msg sip message(pointer - see struct sip_msg) 
- * \param header_name 
- * \return  the paths of the headers
+ * Get the content of a certain header.
+ * @param msg - the SIP message 
+ * @param header_name - the name of the SIP header to return the value for.
+ * @returns the list of values in all corresponding headers, pkg_malloced
  */ 
-
 str cscf_get_headers_content(struct sip_msg * msg , str header_name)
 {	
 	str path={0,0};
@@ -1379,11 +1399,10 @@
 }
 
 /**
- * Method for parsing the header from the message 
- * for a specific header 
- * \param msg sip message(pointer)
- * \param header_name string value for the specific header
- * \return header on success NULL  on fail
+ * Returns the first header structure for a given header name. 
+ * @param msg - the SIP message to look into
+ * @param header_name - the name of the header to search for
+ * @returns the hdr_field on success or NULL if not found  
  */
 struct hdr_field* cscf_get_header(struct sip_msg * msg , str header_name)
 {		
@@ -1403,11 +1422,11 @@
 }
 
 /**
- * Delivers the next header on the sip message
- * \param msg pointer to the sip message structure
- * \param header_name  
- * \param last_header 
- * \return header field on success NULL on fail
+ * Returns the next header structure for a given header name.
+ * @param msg - the SIP message to look into
+ * @param header_name - the name of the header to search for
+ * @param last_header - last header to ignore in the search, or NULL if to start from the first one
+ * @returns the hdr_field on success or NULL if not found  
  */
 struct hdr_field* cscf_get_next_header(struct sip_msg * msg ,
 						 str header_name,struct hdr_field* last_header)
@@ -1428,11 +1447,11 @@
 }
 
 /**
- * Gets the next header type
- * \param msg sip message (pointer)
- * \param hdr_types_t type
- * \param hdr_field last header used (pointer)
- * \returns header field, see also data structure hdr_field  and NULL on fail
+ * Returns the next header structure for a given hdr_types_t type.
+ * @param msg - the SIP message to look into
+ * @param type - the type of the header to look for
+ * @param last_header - last header to ignore in the search, or NULL if to start from the first one
+ * @returns the hdr_field on success or NULL if not found  
  */
 struct hdr_field* cscf_get_next_header_type(struct sip_msg * msg ,
 						 hdr_types_t type, struct hdr_field* last_header)
@@ -1456,8 +1475,8 @@
 
 /**
  * Return the P-Visited-Network-ID header
- * \param msg - the SIP message
- * \return the str with the header's body
+ * @param msg - the SIP message
+ * @returns the str with the header's body
  */
 str cscf_get_visited_network_id(struct sip_msg *msg, struct hdr_field **h)
 {
@@ -1490,8 +1509,9 @@
 
 /**
  * Looks for the Authorization header and returns its body.
- * \param msg - the SIP message
- * \return the authorization body
+ * @param msg - the SIP message
+ * @param h - the hdr_field to fill with the result
+ * @returns the authorization body string
  */
 str cscf_get_authorization(struct sip_msg *msg,struct hdr_field **h)
 {
@@ -1518,8 +1538,9 @@
 
 /**
  * Looks for the WWW-Authenticate header and returns its body.
- * \param msg - the SIP message
- * \return the authorization body
+ * @param msg - the SIP message
+ * @param h - the hdr_field to fill with the result
+ * @returns the www-authenticate body
  */
 str cscf_get_authenticate(struct sip_msg *msg,struct hdr_field **h)
 {
@@ -1551,8 +1572,9 @@
 
 /**
  * Looks for the Security-Client header header and returns its body.
- * \param msg - the SIP message
- * \return the authorization body
+ * @param msg - the SIP message
+ * @param h - the hdr_field to fill with the result
+ * @returns the security-client body
  */
 str cscf_get_security_client(struct sip_msg *msg,struct hdr_field **h)
 {
@@ -1584,8 +1606,9 @@
 
 /**
  * Looks for the Security-Verify header header and returns its body.
- * \param msg - the SIP message
- * \return the authorization body
+ * @param msg - the SIP message
+ * @param h - the hdr_field to fill with the result
+ * @returns the security-verify body
  */
 str cscf_get_security_verify(struct sip_msg *msg,struct hdr_field **h)
 {
@@ -1616,9 +1639,10 @@
 }
 
 /**
- * Deletes the given header
- * \param msg - the SIP message
- * \return 1 on success, 0 on error
+ * Deletes the given header.
+ * @param msg - the SIP message
+ * @param h - the header to delete
+ * @returns 1 on success, 0 on error
  */
 int cscf_del_header(struct sip_msg *msg,struct hdr_field *h)
 {
@@ -1636,8 +1660,9 @@
 
 /**
  * Looks for the First Via header and returns its body.
- * \param msg - the SIP message
- * \return the authorization body
+ * @param msg - the SIP message
+ * @param h - the hdr_field to fill with the result
+ * @returns the first via_body
  */
 struct via_body* cscf_get_first_via(struct sip_msg *msg,struct hdr_field **h)
 {
@@ -1658,8 +1683,8 @@
 
 /**
  * Looks for the Last Via header and returns it.
- * \param msg - the SIP message
- * \return the authorization body
+ * @param msg - the SIP message
+ * @returns the last via body body
  */
 struct via_body* cscf_get_last_via(struct sip_msg *msg)
 {
@@ -1697,8 +1722,10 @@
 /**
  * Looks for the UE Via in First Via header and returns its body, or returns last via if
  * first is sip2ims gateway 
- * \param msg - the SIP message
- * \return the authorization body
+ * @param msg - the SIP message
+ * @param pcscf_sip2ims_via_host - host of the sip2ims gateway
+ * @param pcscf_sip2ims_via_port - port of the sip2ims gateway
+ * @returns the via of the UE
  */
 struct via_body* cscf_get_ue_via(struct sip_msg *msg,str pcscf_sip2ims_via_host,int pcscf_sip2ims_via_port)
 {
@@ -1718,8 +1745,8 @@
 static str realm_p={&quot;realm=\&quot;&quot;,7};
 /**
  * Looks for the realm parameter in the Authorization header and returns its value.
- * \param msg - the SIP message
- * \return the realm
+ * @param msg - the SIP message
+ * @returns the realm
  */
 str cscf_get_realm(struct sip_msg *msg)
 {
@@ -1758,8 +1785,12 @@
 
 /**
  * Returns the content of the P-Associated-URI header
- * public_id is pkg_alloced and should be later freed
- * inside values are not duplicated
+ * Public_id is pkg_alloced and should be later freed.
+ * Inside values are not duplicated.
+ * @param msg - the SIP message to look into
+ * @param public_id - array to be allocated and filled with the result
+ * @param public_id_cnt - the size of the public_id array
+ * @returns 1 on success or 0 on error
  */
 int cscf_get_p_associated_uri(struct sip_msg *msg,str **public_id,int *public_id_cnt)
 {
@@ -1816,7 +1847,9 @@
 
 /**
  * Returns the first entry of the P-Associated-URI header.
- * inside value is not duplicated
+ * @param msg - the SIP message to look into
+ * @param public_id - the public identity to be filled with the result
+ * @returns 1 on success or 0 on failure
  */
 int cscf_get_first_p_associated_uri(struct sip_msg *msg,str *public_id)
 {
@@ -1858,8 +1891,9 @@
 static str s_preferred_id={&quot;P-Preferred-Identity&quot;,20};
 /**
  * Looks for the P-Preferred-Identity header and extracts its content
- * \param msg - the sip message
- * \return the event value
+ * @param msg - the SIP message to look into
+ * @param hr - the header ptr to be filled with the result
+ * @returns the preferred identity string or an empty string if none found
  */
 str cscf_get_preferred_identity(struct sip_msg *msg,struct hdr_field **hr)
 {
@@ -1894,9 +1928,10 @@
 
 
 /**
- * Returns the next record route
- * \param msg - the sip message
- * \return the event value
+ * Returns the next route.
+ * @param msg - the sip message
+ * @param start - where to start look for, ignoring itself
+ * @returns the the next route header or NULL if no more found
  */
 struct hdr_field* cscf_get_next_route(struct sip_msg *msg,struct hdr_field *start)
 {
@@ -1929,9 +1964,9 @@
 
 
 /**
- * Looks for the Content-Type header and extracts its content
- * \param msg - the sip message
- * \return the content-type string, or {0,0} if not found
+ * Looks for the Content-Type header and extracts its content.
+ * @param msg - the sip message
+ * @returns the content-type string, or an empty string if not found
  */
 str cscf_get_content_type(struct sip_msg *msg)
 {
@@ -1944,8 +1979,8 @@
 
 /**
  * Looks for the Content-length header and extracts its content
- * \param msg - the sip message
- * \return the content-type string, or {0,0} if not found
+ * @param msg - the sip message
+ * @returns the content length or 0 if not found
  */
 int cscf_get_content_len(struct sip_msg *msg)
 {
@@ -1961,9 +1996,9 @@
  * Returns the content of the Service-Route header.
  * data vector is pkg_alloced and should be later freed
  * inside values are not duplicated
- * \param msg - the SIP message
- * \param size - size of the returned vector, updated
- * \return - the str vector of uris
+ * @param msg - the SIP message
+ * @param size - size of the returned vector, filled with the result
+ * @returns - the str vector of uris
  */
 str* cscf_get_service_route(struct sip_msg *msg,int *size)
 {
@@ -2021,14 +2056,14 @@
 
 
 /**
- * Delivers the originating contact of the message
- * \param msg sip message
- * \param host as string
- * \param port as Integer(pointer)
- * \param transport Protokoll Layer
- * \param 
- * \param
- * \return 1 on success
+ * Returns the originating contact.
+ * @param msg - the SIP message to look into
+ * @param host - the host string to be filled with the result
+ * @param port - the port number to be filled with the result 
+ * @param transport - the transport type to be filled with the result
+ * @param pcscf_sip2ims_via_host - host string for the sip2ims gateway to skip in via
+ * @param pcscf_sip2ims_via_port - port number for the sip2ims gateway to skip in via
+ * @returns 1 on success
  */
 int cscf_get_originating_contact(struct sip_msg *msg,str *host,int *port,int *transport,str pcscf_sip2ims_via_host,int pcscf_sip2ims_via_port)
 {
@@ -2045,12 +2080,13 @@
 
 
 /**
- * Delivers the terminating contact of the message
- * \param msg sip message
- * \param host as string
- * \param port as integer
- * \param transport Protokoll layer
- * \return 1 on success 0 on fail
+ * Returns the terminating contact.
+ * @param msg sip message
+ * @param msg - the SIP message to look into
+ * @param host - the host string to be filled with the result
+ * @param port - the port number to be filled with the result 
+ * @param transport - the transport type to be filled with the result
+ * @returns 1 on success
  */
 int cscf_get_terminating_contact(struct sip_msg *msg,str *host,int *port,int *transport)
 {

Modified: ser_ims/trunk/modules/scscf/sip.h
===================================================================
--- ser_ims/trunk/modules/scscf/sip.h	2006-11-17 23:41:50 UTC (rev 5)
+++ ser_ims/trunk/modules/scscf/sip.h	2006-11-22 12:43:28 UTC (rev 6)
@@ -1,4 +1,58 @@
-  
+/*
+ * $Id$
+ *  
+ * Copyright (C) 2004-2006 FhG Fokus
+ *
+ * This file is part of Open IMS Core - an open source IMS CSCFs &amp; HSS
+ * implementation
+ *
+ * Open IMS Core is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * For a license to use the Open IMS Core software under conditions
+ * other than those described here, or to purchase support for this
+ * software, please contact Fraunhofer FOKUS by e-mail at the following
+ * addresses:
+ *     <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-cscf">info at open-ims.org</A>
+ *
+ * Open IMS Core is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ * 
+ * It has to be noted that this Open Source IMS Core System is not 
+ * intended to become or act as a product in a commercial context! Its 
+ * sole purpose is to provide an IMS core reference implementation for 
+ * IMS technology testing and IMS application prototyping for research 
+ * purposes, typically performed in IMS test-beds.
+ * 
+ * Users of the Open Source IMS Core System have to be aware that IMS
+ * technology may be subject of patents and licence terms, as being 
+ * specified within the various IMS-related IETF, ITU-T, ETSI, and 3GPP
+ * standards. Thus all Open IMS Core users have to take notice of this 
+ * fact and have to agree to check out carefully before installing, 
+ * using and extending the Open Source IMS Core System, if related 
+ * patents and licences may become applicable to the intended usage 
+ * context.  
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+ * 
+ */
+
+ /**
+ * \file
+ *
+ * P/I/S-CSCF Module - Main SIP Operations 
+ * 
+ *  \author Dragos Vingarzan vingarzan -at- fokus dot fraunhofer dot de
+ * 
+ * Copyright (C) 2005 FhG Fokus
+ * 		
+ */  
 #ifndef PIS_CSCF_SIP_H
 #define PIS_CSCF_SIP_H
 
@@ -107,4 +161,4 @@
 int cscf_get_terminating_contact(struct sip_msg *msg,str *host,int *port,int *transport);
 
 
-#endif /* PIS_CSCF_NDS_H */
+#endif /* PIS_CSCF_SIP_H */


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="000001.html">[OpenIMSCore-CSCF] [SVN-ser_ims] r14 - in ser_ims/trunk: .	.settings cfg
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#0">[ date ]</a>
              <a href="thread.html#0">[ thread ]</a>
              <a href="subject.html#0">[ subject ]</a>
              <a href="author.html#0">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openimscore-cscf">More information about the OpenIMSCore-CSCF
mailing list</a><br>
</body></html>
