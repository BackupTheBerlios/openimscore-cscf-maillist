<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [OpenIMSCore-CSCF] open-ims.test could be resolved
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openimscore-cscf/2009-November/index.html" >
   <LINK REL="made" HREF="mailto:openimscore-cscf%40lists.berlios.de?Subject=Re%3A%20%5BOpenIMSCore-CSCF%5D%20open-ims.test%20could%20be%20resolved&In-Reply-To=%3C86485aee0911041641i1ba7cc0cx44c2bf7bf614054d%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001835.html">
   <LINK REL="Next"  HREF="001873.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OpenIMSCore-CSCF] open-ims.test could be resolved</H1>
    <B>rivaldo guedes corr&#234;a j&#250;nior</B> 
    <A HREF="mailto:openimscore-cscf%40lists.berlios.de?Subject=Re%3A%20%5BOpenIMSCore-CSCF%5D%20open-ims.test%20could%20be%20resolved&In-Reply-To=%3C86485aee0911041641i1ba7cc0cx44c2bf7bf614054d%40mail.gmail.com%3E"
       TITLE="[OpenIMSCore-CSCF] open-ims.test could be resolved">rivaldo.correa at ig.com.br
       </A><BR>
    <I>Thu Nov  5 01:41:56 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001835.html">[OpenIMSCore-CSCF] open-ims.test could be resolved
</A></li>
        <LI>Next message: <A HREF="001873.html">[OpenIMSCore-CSCF] open-ims.test could be resolved
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1836">[ date ]</a>
              <a href="thread.html#1836">[ thread ]</a>
              <a href="subject.html#1836">[ subject ]</a>
              <a href="author.html#1836">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I configured BIND9 in a chroot jail and create a link from
/etc/bind/named.conf to /chroot/named/etc/named.conf.

I think a have permission problem in the jail, but it's seems ok:
*ls /chroot/named/etc -la*
total 40
drwxr-xr-x 2 root named 4096 2009-11-04 21:28 .
drwxr-xr-x 9 root named 4096 2009-10-28 22:14 ..
-rw-r--r-- 1 root named 2001 2009-10-28 17:40 localtime
-rw-r--r-- 1 root named  851 2009-11-04 21:28 named.conf
-rw-r--r-- 1 root named  850 2009-11-04 20:18 named.conf~
-rw-r--r-- 1 root root  2080 2009-10-31 09:24 open-ims.dnszone
-rw-r--r-- 1 root root  2091 2009-10-29 19:57 open-ims.dnszone~
-rw-r--r-- 1 root root    93 2009-11-04 19:56 resolv.conf
-rw-r--r-- 1 root root   116 2009-10-31 11:52 resolv.conf~
-rw-r--r-- 1 root root     0 2009-11-04 20:38 teste
-rw-r--r-- 1 root root   115 2009-11-04 20:39 touch

*But the syslog report:*
Nov  4 22:23:51 ubuntu named[8295]: starting BIND 9.5.1-P2 -u bind
Nov  4 22:23:51 ubuntu named[8295]: found 1 CPU, using 1 worker thread
Nov  4 22:23:51 ubuntu named[8295]: using up to 4096 sockets
Nov  4 22:23:51 ubuntu named[8295]: loading configuration from
'/etc/bind/named.conf'
Nov  4 22:23:51 ubuntu named[8295]: none:0: open: /etc/bind/named.conf:
permission denied
Nov  4 22:23:51 ubuntu named[8295]: loading configuration: permission denied
Nov  4 22:23:51 ubuntu named[8295]: exiting (due to fatal error)
Nov  4 22:23:51 ubuntu kernel: [ 6198.102193] type=1503
audit(1257380631.933:13): operation=&quot;inode_permission&quot; requested_mask=&quot;::r&quot;
denied_mask=&quot;::r&quot; fsuid=115 name=&quot;/chroot/named/etc/named.conf&quot; pid=8296
profile=&quot;/usr/sbin/named&quot;
<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-cscf">root at ubuntu</A>:/var/log# ls /chroot/named/etc -la

I'm thinking to change permissions from 700 to 775  on some directories and
to change root group to bind...

Regards
Rivaldo

2009/11/3 rivaldo guedes corr&#234;a j&#250;nior &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-cscf">rivaldo.correa at ig.com.br</A>&gt;

&gt;<i> Hello Chris
</I>&gt;<i> Thank you for this information. I`ll try it.
</I>&gt;<i>
</I>&gt;<i> Regards
</I>&gt;<i> Rivaldo
</I>&gt;<i>
</I>&gt;<i> -------------------------------
</I>&gt;<i> 2009/11/2 &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-cscf">wilbur at gmx.at</A>&gt;
</I>&gt;<i>
</I>&gt;<i>    Hello Rivaldo,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I think your problem arise through wrong DNS server configuration on your
</I>&gt;&gt;<i> IMS server. You configured your server to query two DNS servers:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> *resolv.conf in /etc:*
</I>&gt;&gt;<i> # Generated by NetworkManager
</I>&gt;&gt;<i> nameserver 192.168.1.1 (my gateway for wlan0)
</I>&gt;&gt;<i> nameserver 127.0.0.1
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I assume that 192.168.1.1 is an external one because your named.conf binds
</I>&gt;&gt;<i> only to&#8230;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> liste-on { 127.0.0.1; 0.0.0.0 };
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> (There is also a typo &#8211; it should be listen-on instead of liste-on)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Try to delete nameserver 192.168.1.1 (my gateway for wlan0) in
</I>&gt;&gt;<i> reslov.conf in order to just ask the local DNS server. Your DNS client gets
</I>&gt;&gt;<i> an negative response from 192.168.1.1 for icscf.open-ims.test so the second
</I>&gt;&gt;<i> server (172.0.0.1) is not queryed anymore. Hope this resolves your issue.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> You can also have a look at messages with&#8230;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> tail &#8211;f /var/log/messages
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#8230;during a restart of BIND to see if the DNS server starts successful.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Greetings,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Chris.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> *From:* <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-cscf">openimscore-cscf-bounces at lists.berlios.de</A> [mailto:
</I>&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-cscf">openimscore-cscf-bounces at lists.berlios.de</A>] *On Behalf Of *rivaldo guedes
</I>&gt;&gt;<i> corr&#234;a j&#250;nior
</I>&gt;&gt;<i> *Sent:* Samstag, 31. Oktober 2009 13:52
</I>&gt;&gt;<i> *To:* <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-cscf">openimscore-cscf at lists.berlios.de</A>
</I>&gt;&gt;<i> *Subject:* [OpenIMSCore-CSCF] open-ims.test could be resolved
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hi all
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm user Open Source IMS Core on Ubuntu Jaunty 9.04 kernel 2.6.28.16
</I>&gt;&gt;<i> I have configured the DNS (Bind) Server according to installation guide
</I>&gt;&gt;<i> but after start the Core Components the domain &quot;open-ims.test&quot; can be
</I>&gt;&gt;<i> resolved and the S-csfc and I-cscsf can't connect to HSS.
</I>&gt;&gt;<i> I checked the config files with the files that are running in &quot;IMS in a
</I>&gt;&gt;<i> Bottle&quot; in other machine, but I didn't find the problem.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> *Messages:*
</I>&gt;&gt;<i> HSS:
</I>&gt;&gt;<i> 2009-10-31 10:34:14,762 ERROR
</I>&gt;&gt;<i> de.fhg.fokus.diameter.DiameterPeer.peer.StateMachine - I_Snd_Conn_Req
</I>&gt;&gt;<i> StateMachine: Peer icscf.open-ims.test cannot be resolved.
</I>&gt;&gt;<i> 2009-10-31 10:34:35,778 ERROR
</I>&gt;&gt;<i> de.fhg.fokus.diameter.DiameterPeer.peer.StateMachine - I_Snd_Conn_Req
</I>&gt;&gt;<i> StateMachine: Peer scscf.open-ims.test cannot be resolved.
</I>&gt;&gt;<i> I-CSCF and S-CSCF:
</I>&gt;&gt;<i> 14(4382) WARNING:peer_connect(): Error opening connection to
</I>&gt;&gt;<i> hss.open-ims.test:3868 &gt;No address associated with hostname
</I>&gt;&gt;<i> 14(4382) --- Peer List: ---
</I>&gt;&gt;<i> 14(4382)  S[Closed] hss.open-ims.test:3868 D[ ]
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> *My DNS config are:*
</I>&gt;&gt;<i> *named.conf in chroot/named/etc:*
</I>&gt;&gt;<i> options {
</I>&gt;&gt;<i>    directory       &quot;/conf&quot;;
</I>&gt;&gt;<i>    pid-file        &quot;/var/run/named.pid&quot;;
</I>&gt;&gt;<i>    statistics-file &quot;/var/run/named.stats&quot;;
</I>&gt;&gt;<i>    dump-file       &quot;/var/run/named.db&quot;;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    # hide our &quot;real&quot; version number
</I>&gt;&gt;<i>    version         &quot;[secured]&quot;;
</I>&gt;&gt;<i> };
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> listen-on-v6 { ;;; };
</I>&gt;&gt;<i> liste-on { 127.0.0.1; 0.0.0.0 };
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # The root nameservers
</I>&gt;&gt;<i> zone &quot;.&quot; IN {
</I>&gt;&gt;<i>    type   hint;
</I>&gt;&gt;<i>    file   &quot;chroot/named/conf/db.rootcache&quot;;
</I>&gt;&gt;<i> };
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # localhost - forward zone
</I>&gt;&gt;<i> zone   &quot;localhost&quot; IN {
</I>&gt;&gt;<i>    type    master;
</I>&gt;&gt;<i>    file   &quot;chroot/named/conf/db.localhost&quot;;
</I>&gt;&gt;<i>    notify  no;
</I>&gt;&gt;<i> };
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # localhost - inverse zone
</I>&gt;&gt;<i> zone    &quot;0.0.127.in-addr.arpa&quot; IN {
</I>&gt;&gt;<i>    type   master;
</I>&gt;&gt;<i>    file   &quot;chroot/named/conf/db.127.0.0&quot;;
</I>&gt;&gt;<i>    notify no;
</I>&gt;&gt;<i> };
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # IMS Zone
</I>&gt;&gt;<i> zone &quot;open-ims.test&quot; IN {
</I>&gt;&gt;<i>     type master;
</I>&gt;&gt;<i>     file &quot;chroot/named/etc/open-ims.dnszone&quot;;
</I>&gt;&gt;<i>     allow-update {none; };
</I>&gt;&gt;<i>     notify no;
</I>&gt;&gt;<i> };
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> *open-ims.dnszone in /chroot/named/etc:*
</I>&gt;&gt;<i> $ORIGIN open-ims.test.
</I>&gt;&gt;<i> $TTL 1W
</I>&gt;&gt;<i> @                       1D IN SOA       localhost. root.localhost. (
</I>&gt;&gt;<i>                                         2006101001      ; serial
</I>&gt;&gt;<i>                                         3H              ; refresh
</I>&gt;&gt;<i>                                         15M             ; retry
</I>&gt;&gt;<i>                                         1W              ; expiry
</I>&gt;&gt;<i>                                         1D )            ; minimum
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>                         1D IN NS        ns
</I>&gt;&gt;<i> ns                      1D IN A         127.0.0.1
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> pcscf                   1D IN A         127.0.0.1
</I>&gt;&gt;<i> _sip.pcscf              1D SRV 0 0 4060 pcscf
</I>&gt;&gt;<i> _sip._udp.pcscf         1D SRV 0 0 4060 pcscf
</I>&gt;&gt;<i> _sip._tcp.pcscf         1D SRV 0 0 4060 pcscf
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> icscf                   1D IN A         127.0.0.1
</I>&gt;&gt;<i> _sip                    1D SRV 0 0 5060 icscf
</I>&gt;&gt;<i> _sip._udp               1D SRV 0 0 5060 icscf
</I>&gt;&gt;<i> _sip._tcp               1D SRV 0 0 5060 icscf
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> open-ims.test.          1D IN A         127.0.0.1
</I>&gt;&gt;<i> open-ims.test.          1D IN NAPTR 10 50 &quot;s&quot; &quot;SIP+D2U&quot;    &quot;&quot;
</I>&gt;&gt;<i> _sip._udp.open-ims.test
</I>&gt;&gt;<i> open-ims.test.          1D IN NAPTR 20 50 &quot;s&quot; &quot;SIP+D2T&quot;    &quot;&quot;
</I>&gt;&gt;<i> _sip._tcp.open-ims.test
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> scscf                   1D IN A         127.0.0.1
</I>&gt;&gt;<i> _sip.scscf              1D SRV 0 0 6060 scscf
</I>&gt;&gt;<i> _sip._udp.scscf         1D SRV 0 0 6060 scscf
</I>&gt;&gt;<i> _sip._tcp.scscf         1D SRV 0 0 6060 scscf
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> trcf                    1D IN A         127.0.0.1
</I>&gt;&gt;<i> _sip.trcf               1D SRV 0 0 3060 trcf
</I>&gt;&gt;<i> _sip._udp.trcf          1D SRV 0 0 3060 trcf
</I>&gt;&gt;<i> _sip._tcp.trcf          1D SRV 0 0 3060 trcf
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> bgcf                    1D IN A         127.0.0.1
</I>&gt;&gt;<i> _sip.bgcf               1D SRV 0 0 7060 bgcf
</I>&gt;&gt;<i> _sip._udp.bgcf          1D SRV 0 0 7060 bgcf
</I>&gt;&gt;<i> _sip._tcp.bgcf          1D SRV 0 0 7060 bgcf
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> mgcf                    1D IN A         127.0.0.1
</I>&gt;&gt;<i> _sip.mgcf               1D SRV 0 0 8060 mgcf
</I>&gt;&gt;<i> _sip._udp.mgcf          1D SRV 0 0 8060 mgcf
</I>&gt;&gt;<i> _sip._tcp.mgcf          1D SRV 0 0 8060 mgcf
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> hss                     1D IN A         127.0.0.1
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ue                      1D IN A         127.0.0.1
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> presence                1D IN A         127.0.0.1
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> pcrf                    1D IN A            127.0.0.1
</I>&gt;&gt;<i> clf                    1D IN A            127.0.0.1
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> *resolv.conf in /etc:*
</I>&gt;&gt;<i> # Generated by NetworkManager
</I>&gt;&gt;<i> nameserver 192.168.1.1 (my gateway for wlan0)
</I>&gt;&gt;<i> nameserver 127.0.0.1
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> *hosts in /etc:*
</I>&gt;&gt;<i> 127.0.0.1    localhost
</I>&gt;&gt;<i> 127.0.1.1    open-ims.test    open-ims
</I>&gt;&gt;<i> 192.168.1.34    desktop.open-ims.test desktop
</I>&gt;&gt;<i> # The following lines are desirable for IPv6 capable hosts
</I>&gt;&gt;<i> ::1     localhost ip6-localhost ip6-loopback
</I>&gt;&gt;<i> fe00::0 ip6-localnet
</I>&gt;&gt;<i> ff00::0 ip6-mcastprefix
</I>&gt;&gt;<i> ff02::1 ip6-allnodes
</I>&gt;&gt;<i> ff02::2 ip6-allrouters
</I>&gt;&gt;<i> ff02::3 ip6-allhost
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Someone could help me?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks
</I>&gt;&gt;<i> Rivaldo
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/openimscore-cscf/attachments/20091104/7ad3d8f6/attachment.html">https://lists.berlios.de/pipermail/openimscore-cscf/attachments/20091104/7ad3d8f6/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001835.html">[OpenIMSCore-CSCF] open-ims.test could be resolved
</A></li>
	<LI>Next message: <A HREF="001873.html">[OpenIMSCore-CSCF] open-ims.test could be resolved
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1836">[ date ]</a>
              <a href="thread.html#1836">[ thread ]</a>
              <a href="subject.html#1836">[ subject ]</a>
              <a href="author.html#1836">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openimscore-cscf">More information about the OpenIMSCore-CSCF
mailing list</a><br>
</body></html>
